<!doctype html>
<html lang="es">
<head>
  <title>Clasificador de Flores</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --primary: #6366f1;  /* √çndigo */
      --primary-light: #818cf8;
      --secondary: #10b981; /* Esmeralda */
      --accent: #f59e0b;   /* √Åmbar */
      --error: #ef4444;
      --success: #10b981;
      --background: #f8fafc;
      --card: #ffffff;
      --text: #334155;
      --text-light: #64748b;
      --border: #e2e8f0;
      --shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
    }
    
    [data-theme="dark"] {
      --background: #0f172a;
      --card: #1e293b;
      --text: #e2e8f0;
      --text-light: #94a3b8;
      --border: #334155;
      --shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    * {
      box-sizing: border-box;
      transition: background-color 0.3s, border-color 0.3s;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      text-align: center;
      padding: 20px;
      background-color: var(--background);
      color: var(--text);
      margin: 0;
      min-height: 100vh;
      line-height: 1.6;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%236366f1' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
      background-size: 800px;
      opacity: 0.1;
      z-index: -1;
      pointer-events: none;
    }

    [data-theme="dark"] body::before {
      opacity: 0.08;
      filter: invert(0.8);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    header {
      margin-bottom: 40px;
      position: relative;
    }

    .theme-switch {
      position: absolute;
      top: 10px;
      right: 10px;
      background: var(--card);
      border-radius: 20px;
      padding: 5px;
      display: flex;
      cursor: pointer;
      box-shadow: var(--shadow);
    }

    .theme-icon {
      padding: 5px 10px;
      border-radius: 15px;
      font-size: 14px;
    }

    .theme-icon.active {
      background: var(--primary);
      color: white;
    }

    h1 {
      color: var(--primary);
      font-size: 2.8rem;
      margin: 30px 0 10px;
      font-weight: 700;
      letter-spacing: -0.5px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }

    .subtitle {
      color: var(--text-light);
      font-size: 1.2rem;
      max-width: 600px;
      margin: 0 auto 30px;
    }

    .flash-messages {
      margin: 20px auto;
      max-width: 600px;
    }

    .flash-message {
      padding: 15px;
      margin: 10px 0;
      border-radius: 12px;
      font-weight: bold;
      animation: slideIn 0.5s ease-out;
      box-shadow: var(--shadow);
    }

    .flash-error {
      background-color: #fef2f2;
      color: var(--error);
      border: 1px solid #fee2e2;
    }

    .flash-success {
      background-color: #ecfdf5;
      color: var(--success);
      border: 1px solid #d1fae5;
    }

    [data-theme="dark"] .flash-error {
      background-color: #450a0a;
      border-color: #7f1d1d;
    }

    [data-theme="dark"] .flash-success {
      background-color: #022c22;
      border-color: #047857;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .upload-section {
      max-width: 700px;
      margin: 0 auto 50px;
    }

    .dropzone {
      border: 2px dashed var(--border);
      border-radius: 16px;
      padding: 50px 30px;
      cursor: pointer;
      margin-bottom: 20px;
      background-color: var(--card);
      position: relative;
      transition: all 0.3s ease;
      box-shadow: var(--shadow);
    }

    .dropzone.dragover {
      background-color: rgba(99, 102, 241, 0.05);
      border-color: var(--primary);
    }

    .dropzone.error {
      border-color: var(--error);
      background-color: rgba(239, 68, 68, 0.05);
    }

    .dropzone-content {
      font-size: 1.2rem;
      color: var(--text-light);
    }

    .dropzone-icon {
      font-size: 3rem;
      margin-bottom: 15px;
      color: var(--primary-light);
    }

    .file-info {
      margin-top: 15px;
      font-size: 1rem;
      color: var(--text);
    }

    .supported-formats {
      margin-top: 15px;
      font-size: 0.9rem;
      color: var(--text-light);
    }

    #image-preview {
      margin-top: 20px;
      max-width: 200px;
      max-height: 200px;
      display: none;
      border-radius: 10px;
      box-shadow: var(--shadow);
    }

    button {
      background: linear-gradient(135deg, var(--primary), var(--primary-light));
      color: white;
      border: none;
      padding: 14px 32px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 1.1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(99, 102, 241, 0.3);
      position: relative;
      overflow: hidden;
    }

    button:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(99, 102, 241, 0.4);
    }

    button:active {
      transform: translateY(1px);
    }

    button:disabled {
      background: #cbd5e1;
      transform: none;
      box-shadow: none;
      cursor: not-allowed;
    }

    button::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, 
        transparent, 
        rgba(255, 255, 255, 0.3), 
        transparent);
      transition: 0.5s;
    }

    button:hover::after {
      left: 100%;
    }

    .loader {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 4px solid rgba(99, 102, 241, 0.2);
      border-top: 4px solid var(--primary);
      animation: spin 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
      margin: 40px auto;
      display: none;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .results-section {
      animation: fadeInUp 0.8s ease-out;
      margin-top: 30px;
    }

    @keyframes fadeInUp {
      from { 
        opacity: 0; 
        transform: translateY(30px); 
      }
      to { 
        opacity: 1; 
        transform: translateY(0); 
      }
    }

    .comparison-container {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin: 50px 0;
      flex-wrap: wrap;
    }

    .comparison-card {
      background: var(--card);
      border-radius: 20px;
      box-shadow: var(--shadow);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      overflow: hidden;
      border: none;
      width: 100%;
      max-width: 500px;
      position: relative;
    }

    .comparison-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
    }

    .card-header {
      background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%);
      color: white;
      padding: 25px;
      margin: 0;
      border-radius: 0;
    }

    .comparison-card:nth-child(1) .card-header {
      background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%);
    }

    .comparison-card:nth-child(2) .card-header {
      background: linear-gradient(90deg, var(--secondary) 0%, #34d399 100%);
    }

    .card-header h2 {
      margin: 0;
      font-size: 1.8rem;
      font-weight: 600;
    }

    .model-rating {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 10px;
      font-size: 1rem;
      gap: 5px;
    }

    .star {
      color: #ffd700;
      font-size: 1.2rem;
    }

    .card-content {
      padding: 25px;
    }

    .prediction-result {
      font-size: 1.8rem;
      margin: 20px 0;
      font-weight: 700;
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .flower-icon {
      font-size: 1.5em;
    }

    .confidence-bar-container {
      width: 100%;
      background: var(--border);
      border-radius: 12px;
      margin: 20px 0 30px;
      overflow: hidden;
      height: 40px;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
    }

    .confidence-bar {
      height: 100%;
      border-radius: 12px;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 1.1rem;
      position: relative;
      overflow: hidden;
      transition: width 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .confidence-bar::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, 
        transparent, 
        rgba(255, 255, 255, 0.4), 
        transparent);
      animation: shine 2s infinite;
    }

    @keyframes shine {
      100% {
        left: 100%;
      }
    }

    .model1-bar {
      background: linear-gradient(90deg, var(--primary), var(--primary-light));
    }

    .model2-bar {
      background: linear-gradient(90deg, var(--secondary), #34d399);
    }

    .model-details {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin: 25px 0;
      text-align: left;
    }

    .detail-card {
      background: var(--background);
      border-radius: 12px;
      padding: 15px;
      box-shadow: var(--shadow);
    }

    .detail-card h3 {
      margin: 0 0 8px 0;
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-light);
    }

    .detail-card p {
      margin: 0;
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--text);
    }

    .accuracy-value {
      color: var(--primary);
    }

    .time-value {
      color: var(--secondary);
    }

    h4 {
      margin: 25px 0 15px;
      font-size: 1.3rem;
      font-weight: 600;
      color: var(--text);
      text-align: left;
    }

    .probabilities-list {
      list-style: none;
      padding: 0;
      margin: 0 0 25px 0;
      text-align: left;
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 15px;
      background: var(--background);
    }

    .probabilities-list li {
      padding: 10px 0;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
    }

    .probabilities-list li:last-child {
      border-bottom: none;
    }

    .class-name {
      font-weight: 500;
    }

    .percentage {
      font-weight: 600;
      color: var(--primary);
    }

    .chart-container {
      margin-top: 20px;
      height: 300px;
      position: relative;
    }

    .image-container {
      margin: 50px auto;
      max-width: 500px;
      padding: 20px;
      background: var(--card);
      border-radius: 20px;
      box-shadow: var(--shadow);
    }

    img#uploaded-image {
      max-width: 100%;
      border-radius: 12px;
      box-shadow: var(--shadow);
    }

    @media (max-width: 768px) {
      .comparison-container {
        flex-direction: column;
        align-items: center;
      }
      
      .comparison-card {
        width: 100%;
      }
      
      .chart-container {
        height: 250px;
      }
      
      h1 {
        font-size: 2.2rem;
      }
      
      .dropzone {
        padding: 30px 20px;
      }
    }

    footer {
      margin-top: 60px;
      padding: 20px;
      color: var(--text-light);
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="theme-switch" id="themeSwitch">
        <div class="theme-icon active" data-theme="light">‚òÄÔ∏è</div>
        <div class="theme-icon" data-theme="dark">üåô</div>
      </div>
      
      <h1>üèµÔ∏è Clasificador de Flores con CNN üèµÔ∏è</h1>
      <p class="subtitle">Compara el rendimiento de dos CNNs para clasificar 5 tipos de flores.</p>
    </header>

    <!-- Mensajes flash -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="flash-messages">
          {% for category, message in messages %}
            <div class="flash-message flash-{{ category }}">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <section class="upload-section">
      <form method="POST" enctype="multipart/form-data" id="uploadForm">
        <div class="dropzone" id="dropzone">
          <div class="dropzone-content">
            <div class="dropzone-icon">üìÅ</div>
            Arrastra y suelta una imagen o haz clic para seleccionar
            <div class="file-info" id="fileInfo"></div>
            <div class="supported-formats">
              Formatos soportados: JPG o PNG
            </div>
          </div>
          <input type="file" name="file" id="fileInput" style="display: none;" accept="image/jpeg,image/jpg,image/png,image/gif,image/bmp,image/tiff">
          <img id="image-preview" alt="Vista previa de la imagen">
        </div>
        <button type="submit" id="submitBtn">Clasificar Imagen</button>
      </form>
    </section>

    <div class="loader" id="loader"></div>

    {% if prediction1 or prediction2 %}
    <section class="results-section">
      <div class="comparison-container">
        <div class="comparison-card">
          <div class="card-header">
            <h2>Modelo Complejo</h2>
            <div class="model-rating">
              <span class="star">‚òÖ</span>
              <span class="star">‚òÖ</span>
              <span class="star">‚òÖ</span>
              <span class="star">‚òÜ</span>
              <span class="star">‚òÜ</span>
              <span>(Precisi√≥n: {{ accuracy1 }}%)</span>
            </div>
          </div>
          
          <div class="card-content">
            <div class="prediction-result">
              <span class="flower-icon">üå∏</span>
              {{ prediction1 }} ({{ confidence1 }}%)
            </div>
            
            <div class="confidence-bar-container">
              <div class="confidence-bar model1-bar" data-width="{{ confidence1 }}">{{ confidence1 }}%</div>
            </div>
            
            <div class="model-details">
              <div class="detail-card">
                <h3>Precisi√≥n del modelo</h3>
                <p class="accuracy-value">{{ accuracy1 }}%</p>
              </div>
              
              <div class="detail-card">
                <h3>Tiempo de respuesta</h3>
                <p class="time-value">{{ time1 }} seg</p>
              </div>
            </div>
            
            <h4>Probabilidades por clase:</h4>
            <ul class="probabilities-list">
              {% for class_name, percent in percentages1 %}
                <li>
                  <span class="class-name">{{ class_name }}</span>
                  <span class="percentage">{{ percent }}%</span>
                </li>
              {% endfor %}
            </ul>
            
            <div class="chart-container">
              <canvas id="chart1"></canvas>
            </div>
          </div>
        </div>

        <div class="comparison-card">
          <div class="card-header">
            <h2>Modelo Ligero</h2>
            <div class="model-rating">
              <span class="star">‚òÖ</span>
              <span class="star">‚òÖ</span>
              <span class="star">‚òÖ</span>
              <span class="star">‚òÖ</span>
              <span class="star">‚òÜ</span>
              <span>(Precisi√≥n: {{ accuracy2 }}%)</span>
            </div>
          </div>
          
          <div class="card-content">
            <div class="prediction-result">
              <span class="flower-icon">üå∏</span>
              {{ prediction2 }} ({{ confidence2 }}%)
            </div>
            
            <div class="confidence-bar-container">
              <div class="confidence-bar model2-bar" data-width="{{ confidence2 }}">{{ confidence2 }}%</div>
            </div>
            
            <div class="model-details">
              <div class="detail-card">
                <h3>Precisi√≥n del modelo</h3>
                <p class="accuracy-value">{{ accuracy2 }}%</p>
              </div>
              
              <div class="detail-card">
                <h3>Tiempo de respuesta</h3>
                <p class="time-value">{{ time2 }} seg</p>
              </div>
            </div>
            
            <h4>Probabilidades por clase:</h4>
            <ul class="probabilities-list">
              {% for class_name, percent in percentages2 %}
                <li>
                  <span class="class-name">{{ class_name }}</span>
                  <span class="percentage">{{ percent }}%</span>
                </li>
              {% endfor %}
            </ul>
            
            <div class="chart-container">
              <canvas id="chart2"></canvas>
            </div>
          </div>
        </div>
      </div>

      <div class="image-container">
        <h3>Imagen analizada:</h3>
        <img id="uploaded-image" src="{{ url_for('static', filename='uploads/' + filename) }}" alt="Imagen subida">
      </div>
    </section>
    {% endif %}
    
    <footer>
      <p>Sistema de clasificaci√≥n de flores con CNN - Iv√°n Rodr√≠guez Cuevas</p>
    </footer>
  </div>

  <!-- Datos para las gr√°ficas -->
  {% if prediction1 and prediction2 and percentages1 and percentages2 %}
  <script type="application/json" id="chart-data">
  {
    "labels": {{ class_names | tojson }},
    "model1Data": {{ percentages1 | map(attribute=1) | list | tojson }},
    "model2Data": {{ percentages2 | map(attribute=1) | list | tojson }}
  }
  </script>
  {% endif %}

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // ===== TEMA OSCURO/CLARO =====
    const themeSwitch = document.getElementById('themeSwitch');
    const themeIcons = document.querySelectorAll('.theme-icon');
    const html = document.documentElement;
    
    // Comprobar preferencia del sistema
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const savedTheme = localStorage.getItem('theme');
    
    // Aplicar tema guardado o preferencia del sistema
    if (savedTheme) {
      html.setAttribute('data-theme', savedTheme);
      updateThemeIcons(savedTheme);
    } else if (prefersDark) {
      html.setAttribute('data-theme', 'dark');
      updateThemeIcons('dark');
    }
    
    // Cambiar tema
    themeSwitch.addEventListener('click', (e) => {
      if (e.target.classList.contains('theme-icon')) {
        const theme = e.target.getAttribute('data-theme');
        html.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        updateThemeIcons(theme);
      }
    });
    
    function updateThemeIcons(theme) {
      themeIcons.forEach(icon => {
        if (icon.getAttribute('data-theme') === theme) {
          icon.classList.add('active');
        } else {
          icon.classList.remove('active');
        }
      });
    }
    
    // ===== CONFIGURACI√ìN DE BARRAS DE CONFIANZA =====
    document.querySelectorAll('.confidence-bar').forEach(bar => {
      const width = bar.getAttribute('data-width');
      if (width) {
        // Aplicar despu√©s de un peque√±o retraso para permitir la animaci√≥n
        setTimeout(() => {
          bar.style.width = `${width}%`;
        }, 100);
      }
    });
    
    // ===== FUNCIONALIDAD DRAG & DROP =====
    const dropzone = document.getElementById('dropzone');
    const fileInput = document.getElementById('fileInput');
    const imagePreview = document.getElementById('image-preview');
    const loader = document.getElementById('loader');
    const form = document.getElementById('uploadForm');
    const fileInfo = document.getElementById('fileInfo');
    const submitBtn = document.getElementById('submitBtn');
    
    const allowedFormats = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'tiff'];
    
    function getFileExtension(filename) {
      return filename.split('.').pop().toLowerCase();
    }
    
    function isValidFile(file) {
      const extension = getFileExtension(file.name);
      return allowedFormats.includes(extension);
    }
    
    function isWebPFile(file) {
      return getFileExtension(file.name) === 'webp';
    }
    
    function showFileError(message) {
      dropzone.classList.add('error');
      fileInfo.innerHTML = `<span style="color: var(--error);"> ${message}</span>`;
      submitBtn.disabled = true;
      setTimeout(() => {
        dropzone.classList.remove('error');
      }, 3000);
    }
    
    function showFileSuccess(filename) {
      dropzone.classList.remove('error');
      fileInfo.innerHTML = `<span style="color: var(--success);"> Archivo seleccionado: ${filename}</span>`;
      submitBtn.disabled = false;
    }
    
    function handleFile(file) {
      if (!file) return;
    
      if (isWebPFile(file)) {
        showFileError('Los archivos WebP no son compatibles. Usa JPG o PNG.');
        fileInput.value = '';
        imagePreview.style.display = 'none';
        return;
      }
    
      if (!isValidFile(file)) {
        showFileError('Formato no permitido. Usa: JPG, PNG, GIF, BMP o TIFF.');
        fileInput.value = '';
        imagePreview.style.display = 'none';
        return;
      }
    
      showFileSuccess(file.name);
      
      const reader = new FileReader();
      reader.onload = function(e) {
        imagePreview.src = e.target.result;
        imagePreview.style.display = 'block';
      }
      reader.readAsDataURL(file);
    }
    
    fileInput.addEventListener('change', function(e) {
      handleFile(e.target.files[0]);
    });
    
    dropzone.addEventListener('click', () => fileInput.click());
    
    dropzone.addEventListener('dragover', (e) => {
      e.preventDefault();
      dropzone.classList.add('dragover');
    });
    
    dropzone.addEventListener('dragleave', () => {
      dropzone.classList.remove('dragover');
    });
    
    dropzone.addEventListener('drop', (e) => {
      e.preventDefault();
      dropzone.classList.remove('dragover');
      const file = e.dataTransfer.files[0];
      fileInput.files = e.dataTransfer.files;
      handleFile(file);
    });
    
    form.addEventListener('submit', function(e) {
      const file = fileInput.files[0];
      if (!file) {
        e.preventDefault();
        showFileError('Por favor selecciona un archivo');
        return;
      }
      
      if (isWebPFile(file) || !isValidFile(file)) {
        e.preventDefault();
        return;
      }
      
      loader.style.display = 'block';
      submitBtn.disabled = true;
      submitBtn.textContent = 'Procesando...';
    });
    
    // Ocultar mensajes flash despu√©s de 5 segundos
    setTimeout(() => {
      const flashMessages = document.querySelectorAll('.flash-message');
      flashMessages.forEach(msg => {
        msg.style.transition = 'opacity 0.5s ease-out';
        msg.style.opacity = '0';
        setTimeout(() => msg.remove(), 500);
      });
    }, 5000);
    
    // ===== CONFIGURACI√ìN DE GR√ÅFICAS =====
    const chartDataElement = document.getElementById('chart-data');
    if (chartDataElement) {
      const chartData = JSON.parse(chartDataElement.textContent);
      
      const labels = chartData.labels;
      const model1Data = chartData.model1Data;
      const model2Data = chartData.model2Data;
      
      // Configuraci√≥n com√∫n para ambas gr√°ficas
      const chartConfig = {
        type: 'bar',
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false
            },
            title: {
              display: true,
              text: 'Distribuci√≥n de probabilidades',
              font: {
                size: 16,
                weight: '600'
              },
              color: 'var(--text)',
              padding: {
                top: 10,
                bottom: 20
              }
            },
            tooltip: {
              backgroundColor: 'rgba(30, 30, 30, 0.85)',
              padding: 12,
              cornerRadius: 8,
              displayColors: false,
              callbacks: {
                label: function(context) {
                  return `${context.dataset.label}: ${context.raw}%`;
                },
                title: function(context) {
                  return labels[context[0].dataIndex];
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              max: 100,
              grid: {
                color: 'var(--border)'
              },
              ticks: {
                callback: function(value) {
                  return value + '%';
                },
                font: {
                  size: 12
                },
                color: 'var(--text-light)'
              },
              title: {
                display: true,
                text: 'Probabilidad',
                font: {
                  size: 14,
                  weight: '600'
                },
                color: 'var(--text)',
                padding: {
                  top: 10,
                  bottom: 10
                }
              }
            },
            x: {
              grid: {
                display: false
              },
              ticks: {
                maxRotation: 45,
                minRotation: 30,
                font: {
                  size: 12
                },
                color: 'var(--text)'
              },
              title: {
                display: true,
                text: 'Clases de flores',
                font: {
                  size: 14,
                  weight: '600'
                },
                color: 'var(--text)',
                padding: {
                  top: 15
                }
              }
            }
          },
          layout: {
            padding: {
              left: 10,
              right: 10,
              top: 10,
              bottom: 30
            }
          },
          animation: {
            duration: 1000,
            easing: 'easeOutQuart'
          }
        }
      };
      
      // Gr√°fica para Modelo 1
      const ctx1 = document.getElementById('chart1').getContext('2d');
      new Chart(ctx1, {
        ...chartConfig,
        data: {
          labels: labels,
          datasets: [{
            label: 'Confianza (%)',
            data: model1Data,
            backgroundColor: [
              '#6366f1', '#818cf8', '#a5b4fc', '#c7d2fe', '#e0e7ff'
            ],
            borderColor: '#4f46e5',
            borderWidth: 1,
            borderRadius: 8,
            borderSkipped: false,
          }]
        }
      });
      
      // Gr√°fica para Modelo 2
      const ctx2 = document.getElementById('chart2').getContext('2d');
      new Chart(ctx2, {
        ...chartConfig,
        data: {
          labels: labels,
          datasets: [{
            label: 'Confianza (%)',
            data: model2Data,
            backgroundColor: [
              '#10b981', '#34d399', '#6ee7b7', '#a7f3d0', '#d1fae5'
            ],
            borderColor: '#059669',
            borderWidth: 1,
            borderRadius: 8,
            borderSkipped: false,
          }]
        }
      });
    }
  </script>
</body>
</html>